var q=Object.defineProperty;var J=(e,t,a)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var i=(e,t,a)=>(J(e,typeof t!="symbol"?t+"":t,a),a);import{c as j,r as S,S as z,A as f,a8 as W,_ as X,p as o,q as _,Q as u,O as A,P as O,v,R as T,s as w,w as x,x as Q}from"./framework-c7fc5b18.js";const g=class{constructor(t,a,n){i(this,"startDate");i(this,"endDate");i(this,"max");i(this,"_values");i(this,"_firstFullWeekOfMonths");i(this,"_activities");i(this,"_calendar");this.endDate=this.parseDate(t),this.max=n||Math.ceil(Math.max(...a.map(d=>d.count))/5*4),this.startDate=this.shiftDate(t,-g.DAYS_IN_ONE_YEAR),this._values=a}set values(t){this.max=Math.ceil(Math.max(...t.map(a=>a.count))/5*4),this._values=t,this._firstFullWeekOfMonths=void 0,this._calendar=void 0,this._activities=void 0}get values(){return this._values}get activities(){if(!this._activities){this._activities=new Map;for(let t=0,a=this.values.length;t<a;t++)this._activities.set(this.keyDayParser(this.values[t].date),{count:this.values[t].count,colorIndex:this.getColorIndex(this.values[t].count)})}return this._activities}get weekCount(){return this.getDaysCount()/g.DAYS_IN_WEEK}get calendar(){if(!this._calendar){let t=this.shiftDate(this.startDate,-this.getCountEmptyDaysAtStart());t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),this._calendar=new Array(this.weekCount);for(let a=0,n=this._calendar.length;a<n;a++){this._calendar[a]=new Array(g.DAYS_IN_WEEK);for(let d=0;d<g.DAYS_IN_WEEK;d++){const l=this.activities.get(this.keyDayParser(t));this._calendar[a][d]={date:new Date(t.valueOf()),count:l?l.count:void 0,colorIndex:l?l.colorIndex:0},t.setDate(t.getDate()+1)}}}return this._calendar}get firstFullWeekOfMonths(){if(!this._firstFullWeekOfMonths){const t=this.calendar;this._firstFullWeekOfMonths=[];for(let a=1,n=t.length;a<n;a++){const d=t[a-1][0].date,l=t[a][0].date;(d.getFullYear()<l.getFullYear()||d.getMonth()<l.getMonth())&&this._firstFullWeekOfMonths.push({value:l.getMonth(),index:a})}}return this._firstFullWeekOfMonths}getColorIndex(t){return t==null?0:t<=0?1:t>=this.max?5:Math.ceil(t*100/this.max*.03)+1}getCountEmptyDaysAtStart(){return this.startDate.getDay()}getCountEmptyDaysAtEnd(){return g.DAYS_IN_WEEK-1-this.endDate.getDay()}getDaysCount(){return g.DAYS_IN_ONE_YEAR+1+this.getCountEmptyDaysAtStart()+this.getCountEmptyDaysAtEnd()}shiftDate(t,a){const n=new Date(t);return n.setDate(n.getDate()+a),n}parseDate(t){return t instanceof Date?t:new Date(t)}keyDayParser(t){const a=this.parseDate(t);return String(a.getFullYear())+String(a.getMonth()).padStart(2,"0")+String(a.getDate()).padStart(2,"0")}};let r=g;i(r,"DEFAULT_RANGE_COLOR_LIGHT",["#ebedf0","#dae2ef","#c0ddf9","#73b3f3","#3886e1","#17459e"]),i(r,"DEFAULT_RANGE_COLOR_DARK",["#1f1f22","#1e334a","#1d466c","#1d5689","#1d69ac","#1B95D1"]),i(r,"DEFAULT_LOCALE",{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],on:"on",less:"Less",more:"More"}),i(r,"DEFAULT_TOOLTIP_UNIT","contributions"),i(r,"DAYS_IN_ONE_YEAR",365),i(r,"DAYS_IN_WEEK",7),i(r,"SQUARE_SIZE",10);const ee=j({name:"CalendarHeatmap",props:{endDate:{required:!0},max:{type:Number},rangeColor:{type:Array},values:{type:Array,required:!0},locale:{type:Object},tooltip:{type:Boolean,default:!0},tooltipUnit:{type:String,default:r.DEFAULT_TOOLTIP_UNIT},tooltipFormatter:{type:Function},vertical:{type:Boolean,default:!1},noDataText:{type:[Boolean,String],default:null},round:{type:Number,default:0},darkMode:Boolean},emits:["dayClick"],setup(e){const t=r.SQUARE_SIZE/5,a=r.SQUARE_SIZE+t,n=Math.ceil(r.SQUARE_SIZE*2.5),d=a*3,l=r.SQUARE_SIZE+r.SQUARE_SIZE/2,E=r.SQUARE_SIZE+r.SQUARE_SIZE/2,h=`translate(${n}, ${l})`,c=S(null),y=S(new Date),R=S(new r(e.endDate,e.values,e.max)),D=S(0),m=S(0),Z=S("0 0 0 0"),k=S("0 0 0 0"),p=S(""),C=S(""),L=S(""),M=S({}),I=S(e.rangeColor||(e.darkMode?r.DEFAULT_RANGE_COLOR_DARK:r.DEFAULT_RANGE_COLOR_LIGHT)),{values:F,tooltipUnit:$,tooltipFormatter:B,noDataText:b,max:Y,vertical:N,locale:P}=z(e);function G(s){return e.vertical?`translate(0, ${a*R.value.weekCount-(s+1)*a})`:`translate(${s*a}, 0)`}function K(s){return e.vertical?`translate(${s*a}, 0)`:`translate(0, ${s*a})`}function H(s){return e.vertical?{x:3,y:a*R.value.weekCount-a*s.index-a/4}:{x:a*s.index,y:a-t}}return f([W(e,"rangeColor"),W(e,"darkMode")],([s,U])=>{I.value=s||(U?r.DEFAULT_RANGE_COLOR_DARK:r.DEFAULT_RANGE_COLOR_LIGHT)}),f(N,s=>{s?(D.value=n+a*r.DAYS_IN_WEEK+d,m.value=l+a*R.value.weekCount+t,p.value=`translate(${n}, 0)`,C.value=`translate(0, ${l})`):(D.value=n+a*R.value.weekCount+t,m.value=l+a*r.DAYS_IN_WEEK,p.value=`translate(0, ${l})`,C.value=`translate(${n}, 0)`)},{immediate:!0}),f([D,m],([s,U])=>Z.value=` 0 0 ${s} ${U}`,{immediate:!0}),f([D,m,I],([s,U,V])=>{L.value=N.value?`translate(${n+a*r.DAYS_IN_WEEK}, ${l})`:`translate(${s-a*V.length-30}, ${U-E})`},{immediate:!0}),f(P,s=>M.value=s?{...r.DEFAULT_LOCALE,...s}:r.DEFAULT_LOCALE,{immediate:!0}),f(I,s=>k.value=`0 0 ${r.SQUARE_SIZE*(s.length+1)} ${r.SQUARE_SIZE}`,{immediate:!0}),f([F,$,B,b,Y,I],()=>{R.value=new r(e.endDate,e.values,e.max)}),{SQUARE_BORDER_SIZE:t,SQUARE_SIZE:a,LEFT_SECTION_WIDTH:n,RIGHT_SECTION_WIDTH:d,TOP_SECTION_HEIGHT:l,BOTTOM_SECTION_HEIGHT:E,svg:c,heatmap:R,now:y,width:D,height:m,viewbox:Z,daysLabelWrapperTransform:p,monthsLabelWrapperTransform:C,yearWrapperTransform:h,legendWrapperTransform:L,lo:M,legendViewbox:k,curRangeColor:I,getWeekPosition:G,getDayPosition:K,getMonthLabelPosition:H}}});const te=["viewBox"],ae=["transform"],re=["x","y"],se=["transform"],ne=["x","y"],le=["x","y"],ie=["x","y"],oe=["transform"],_e=["x"],ue=["rx","ry","width","height","x","y"],he=["x","y"],de=["transform"],Ee=["transform"],Se=["rx","ry","transform","width","height","data-week-index","data-day-index","onClick"],ve={class:"vch__legend"},ge={class:"vch__legend-left"},Re={class:"vch__legend-right"},fe={class:"vch__legend"},Ae=["viewBox","height"],ce={class:"vch__legend__wrapper"},ye=["rx","ry","width","height","x"];function De(e,t,a,n,d,l){return o(),_("div",{class:x({vch__container:!0,"dark-mode":e.darkMode})},[(o(),_("svg",{class:"vch__wrapper",ref:"svg",viewBox:e.viewbox},[u("g",{class:"vch__months__labels__wrapper",transform:e.monthsLabelWrapperTransform},[(o(!0),_(A,null,O(e.heatmap.firstFullWeekOfMonths,(E,h)=>(o(),_("text",{class:"vch__month__label",key:h,x:e.getMonthLabelPosition(E).x,y:e.getMonthLabelPosition(E).y},v(e.lo.months[E.value]),9,re))),128))],8,ae),u("g",{class:"vch__days__labels__wrapper",transform:e.daysLabelWrapperTransform},[u("text",{class:"vch__day__label",x:e.vertical?e.SQUARE_SIZE:0,y:e.vertical?e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE:20},v(e.lo.days[1]),9,ne),u("text",{class:"vch__day__label",x:e.vertical?e.SQUARE_SIZE*3:0,y:e.vertical?e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE:44},v(e.lo.days[3]),9,le),u("text",{class:"vch__day__label",x:e.vertical?e.SQUARE_SIZE*5:0,y:e.vertical?e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE:69},v(e.lo.days[5]),9,ie)],8,se),e.vertical?(o(),_("g",{key:0,class:"vch__legend__wrapper",transform:e.legendWrapperTransform},[u("text",{x:e.SQUARE_SIZE*1.25,y:"8"},v(e.lo.less),9,_e),(o(!0),_(A,null,O(e.curRangeColor,(E,h)=>(o(),_("rect",{key:h,rx:e.round,ry:e.round,style:Q({fill:E}),width:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,height:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,x:e.SQUARE_SIZE*1.75,y:e.SQUARE_SIZE*(h+1)},null,12,ue))),128)),u("text",{x:e.SQUARE_SIZE*1.25,y:e.SQUARE_SIZE*(e.curRangeColor.length+2)-e.SQUARE_BORDER_SIZE},v(e.lo.more),9,he)],8,oe)):T("v-if",!0),u("g",{class:"vch__year__wrapper",transform:e.yearWrapperTransform},[(o(!0),_(A,null,O(e.heatmap.calendar,(E,h)=>(o(),_("g",{class:"vch__month__wrapper",key:h,transform:e.getWeekPosition(h)},[(o(!0),_(A,null,O(E,(c,y)=>(o(),_(A,{key:y},[c.date<e.now?(o(),_("rect",{key:0,class:"vch__day__square",rx:e.round,ry:e.round,transform:e.getDayPosition(y),width:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,height:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,style:Q({fill:e.curRangeColor[c.colorIndex]}),"data-week-index":h,"data-day-index":y,onClick:R=>e.$emit("dayClick",c)},null,12,Se)):T("v-if",!0)],64))),128))],8,Ee))),128))],8,de)],8,te)),u("div",ve,[w(e.$slots,"legend",{},()=>[u("div",ge,[w(e.$slots,"vch__legend-left")]),u("div",Re,[w(e.$slots,"legend-right",{},()=>[u("div",fe,[u("div",null,v(e.lo.less),1),e.vertical?T("v-if",!0):(o(),_("svg",{key:0,class:"vch__external-legend-wrapper",viewBox:e.legendViewbox,height:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE},[u("g",ce,[(o(!0),_(A,null,O(e.curRangeColor,(E,h)=>(o(),_("rect",{key:h,rx:e.round,ry:e.round,style:Q({fill:E}),width:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,height:e.SQUARE_SIZE-e.SQUARE_BORDER_SIZE,x:e.SQUARE_SIZE*h},null,12,ye))),128))])],8,Ae)),u("div",null,v(e.lo.more),1)])])])])])],2)}const Ue=X(ee,[["render",De],["__file","CalendarHeatmap.vue"]]);export{Ue as default};
